<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Secure Note Locker ‚Äî CryptoJS + Validator.js + FingerprintJS (Single File)</title>

  <!-- Tailwind (CDN) ‡§∏‡§ø‡§∞‡•ç‡§´‡§º UI ‡§ï‡•á ‡§≤‡§ø‡§è -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- CryptoJS (AES/Hash) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js" integrity="sha512-fuV9Wm0YtQ2nqj3mJvZkfhRkY8n+0v6k8t07xQ7mG6B3uGqD7tRDbJkK9Lr0bJ8z1c7qWqn0wGmJfR2KelG1Bw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- validator.js (‡§´‡•â‡§∞‡•ç‡§Æ ‡§µ‡•à‡§≤‡§ø‡§°‡•á‡§∂‡§®) -->
  <script src="https://cdn.jsdelivr.net/npm/validator@13.11.0/validator.min.js"></script>

  <!-- FingerprintJS v3 (‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§´‡§ø‡§Ç‡§ó‡§∞‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü) -->
  <script async src="https://openfpcdn.io/fingerprintjs/v3"></script>

  <style>
    /* ‡§ï‡•Å‡§õ subtle custom styles */
    .glass {
      backdrop-filter: blur(10px);
      background: rgba(255,255,255,0.75);
    }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; }
    .fade-in { animation: fade 0.4s ease-in-out; }
    @keyframes fade { from {opacity:.4; transform: translateY(4px);} to {opacity:1; transform: translateY(0);} }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-100">
  <div class="max-w-4xl mx-auto px-4 py-8">
    <header class="mb-8">
      <h1 class="text-3xl md:text-4xl font-bold tracking-tight">üîê Secure Note Locker</h1>
      <p class="text-slate-300 mt-1">CryptoJS + Validator.js + FingerprintJS + AJAX (Single File)</p>
    </header>

    <main class="grid lg:grid-cols-5 gap-6 items-start">
      <!-- Left: Form -->
      <section class="lg:col-span-3 glass rounded-2xl shadow-xl p-5 md:p-6 fade-in">
        <h2 class="text-xl font-semibold mb-4">üìù ‡§Ö‡§™‡§®‡•Ä Secure Note ‡§¨‡§®‡§æ‡§è‡§Ç</h2>
        <form id="noteForm" class="space-y-4" autocomplete="off" novalidate>
          <!-- Email -->
          <div>
            <label for="email" class="block text-sm font-medium text-slate-200 mb-1">‡§à‡§Æ‡•á‡§≤</label>
            <input id="email" type="email" class="w-full rounded-xl px-3 py-2 bg-slate-900/60 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="name@example.com"/>
            <p id="emailHelp" class="text-xs text-slate-400 mt-1">‡§à‡§Æ‡•á‡§≤ ‡§∏‡§π‡•Ä ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è (validator.js ‡§∏‡•á ‡§ö‡•á‡§ï)</p>
          </div>

          <!-- Password -->
          <div>
            <label for="password" class="block text-sm font-medium text-slate-200 mb-1">‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°</label>
            <input id="password" type="password" class="w-full rounded-xl px-3 py-2 bg-slate-900/60 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 8 ‡§Ö‡§ï‡•ç‡§∑‡§∞ + 1 ‡§®‡§Ç‡§¨‡§∞ + 1 ‡§∏‡•ç‡§™‡•á‡§∂‡§≤"/>
            <p id="pwdHelp" class="text-xs text-slate-400 mt-1">‡§Æ‡§ú‡§º‡§¨‡•Ç‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∞‡§ñ‡•á‡§Ç; ‡§Ø‡§π‡•Ä ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§ï‡•Ä ‡§ï‡•á ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§Ø‡•Ç‡§ú‡§º ‡§π‡•ã‡§ó‡§æ‡•§</p>
          </div>

          <!-- Note -->
          <div>
            <label for="note" class="block text-sm font-medium text-slate-200 mb-1">‡§®‡•ã‡§ü (‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü)</label>
            <textarea id="note" rows="6" class="w-full rounded-xl px-3 py-2 bg-slate-900/60 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ ‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç‚Ä¶"></textarea>
            <div class="flex items-center justify-between mt-2">
              <button type="button" id="btnEncrypt" class="rounded-xl px-4 py-2 bg-indigo-600 hover:bg-indigo-500 active:bg-indigo-700 transition">Encrypt & Save</button>
              <div class="text-xs text-slate-400">‡§≤‡•ã‡§ï‡§≤‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§Æ‡•á‡§Ç ‡§ï‡•á‡§µ‡§≤ <em>encrypted</em> ‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ‡•§</div>
            </div>
          </div>

          <!-- Actions -->
          <div class="flex flex-wrap gap-2 pt-2">
            <button type="button" id="btnDecrypt" class="rounded-xl px-4 py-2 bg-emerald-600 hover:bg-emerald-500 active:bg-emerald-700 transition">Decrypt Note</button>
            <button type="button" id="btnCopy" class="rounded-xl px-4 py-2 bg-slate-700 hover:bg-slate-600 active:bg-slate-800 transition">Copy Decrypted</button>
            <button type="button" id="btnClear" class="rounded-xl px-4 py-2 bg-rose-600 hover:bg-rose-500 active:bg-rose-700 transition">Clear Storage</button>
            <button type="button" id="btnSync" class="rounded-xl px-4 py-2 bg-teal-600 hover:bg-teal-500 active:bg-teal-700 transition">AJAX Sync</button>
          </div>
        </form>

        <!-- Validation / Status -->
        <div id="status" class="mt-4 text-sm"></div>
      </section>

      <!-- Right: Info / Output -->
      <aside class="lg:col-span-2 space-y-6">
        <div class="glass rounded-2xl shadow-xl p-5 md:p-6 fade-in">
          <h3 class="text-lg font-semibold mb-2">üÜî ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§´‡§º‡§ø‡§Ç‡§ó‡§∞‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü</h3>
          <p class="text-sm text-slate-300">FingerprintJS ‡§∏‡•á ‡§ú‡•á‡§®‡§∞‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§Ø‡•Ç‡§®‡§ø‡§ï ID:</p>
          <pre id="fpOut" class="mono bg-slate-900/60 border border-slate-700 rounded-xl p-3 mt-2 text-xs whitespace-pre-wrap break-all">Generating‚Ä¶</pre>
        </div>

        <div class="glass rounded-2xl shadow-xl p-5 md:p-6 fade-in">
          <h3 class="text-lg font-semibold mb-2">üîé ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü</h3>
          <pre id="out" class="mono bg-slate-900/60 border border-slate-700 rounded-xl p-3 text-sm whitespace-pre-wrap break-words min-h-[120px]">‚Äî</pre>
        </div>

        <div class="glass rounded-2xl shadow-xl p-5 md:p-6 fade-in">
          <h3 class="text-lg font-semibold mb-2">üåê AJAX Response</h3>
          <p class="text-sm text-slate-300">‡§°‡•á‡§Æ‡•ã POST: <span class="underline decoration-dotted">https://httpbin.org/post</span></p>
          <pre id="ajaxOut" class="mono bg-slate-900/60 border border-slate-700 rounded-xl p-3 text-xs whitespace-pre-wrap break-all min-h-[120px]">‚Äî</pre>
        </div>
      </aside>
    </main>

    <footer class="mt-10 text-center text-xs text-slate-400">
      Made with ‚ù§Ô∏è using CryptoJS, Validator.js, FingerprintJS & fetch
    </footer>
  </div>

  <script>
    // -------------------------------
    // Utility Helpers
    // -------------------------------
    const $ = (id) => document.getElementById(id);

    function setStatus(msg, type = "info") {
      const el = $("status");
      const base = "mt-4 text-sm px-3 py-2 rounded-xl border ";
      const color = {
        info:   "bg-slate-900/60 border-slate-700 text-slate-200",
        ok:     "bg-emerald-900/40 border-emerald-700 text-emerald-200",
        warn:   "bg-amber-900/40 border-amber-700 text-amber-200",
        err:    "bg-rose-900/40 border-rose-700 text-rose-200",
      }[type] || color.info;

      el.className = base + color;
      el.textContent = msg;
    }

    function validateEmail(email) {
      return validator.isEmail(email || "");
    }

    function validatePassword(pwd) {
      // ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 8, ‡§è‡§ï ‡§®‡§Ç‡§¨‡§∞, ‡§è‡§ï ‡§∏‡•ç‡§™‡•á‡§∂‡§≤
      if (typeof pwd !== "string") return false;
      const longEnough = pwd.length >= 8;
      const hasNum = /\d/.test(pwd);
      const hasSpecial = /[^A-Za-z0-9]/.test(pwd);
      return longEnough && hasNum && hasSpecial;
    }

    function encryptNote(note, password) {
      // AES ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§®
      return CryptoJS.AES.encrypt(note, password).toString();
    }

    function decryptNote(cipherText, password) {
      try {
        const bytes = CryptoJS.AES.decrypt(cipherText, password);
        const text = bytes.toString(CryptoJS.enc.Utf8);
        return text || null;
      } catch (e) {
        return null;
      }
    }

    function sha256Hex(text) {
      return CryptoJS.SHA256(text).toString(CryptoJS.enc.Hex);
    }

    // -------------------------------
    // FingerprintJS Init
    // -------------------------------
    let FP_VISITOR_ID = null;

    async function initFingerprint() {
      try {
        // global FingerprintJS loaded from CDN (v3)
        const fp = await FingerprintJS.load({ monitoring: false });
        const result = await fp.get();
        FP_VISITOR_ID = result.visitorId;
        $("fpOut").textContent = FP_VISITOR_ID;
      } catch (err) {
        $("fpOut").textContent = "Fingerprint error: " + err?.message;
      }
    }

    // -------------------------------
    // App Logic
    // -------------------------------
    const LS_KEY = "secure_note_encrypted_v1";
    const LS_META = "secure_note_meta_v1"; // email hash + fp snapshot

    function persist(cipher, meta) {
      localStorage.setItem(LS_KEY, cipher);
      localStorage.setItem(LS_META, JSON.stringify(meta || {}));
    }

    function loadPersisted() {
      return {
        cipher: localStorage.getItem(LS_KEY),
        meta: JSON.parse(localStorage.getItem(LS_META) || "{}"),
      };
    }

    function clearPersisted() {
      localStorage.removeItem(LS_KEY);
      localStorage.removeItem(LS_META);
    }

    async function handleEncrypt() {
      const email = $("email").value.trim();
      const password = $("password").value;
      const note = $("note").value;

      // Validation
      if (!validateEmail(email)) {
        setStatus("‡§à‡§Æ‡•á‡§≤ ‡§µ‡•à‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§", "warn");
        return;
      }
      if (!validatePassword(password)) {
        setStatus("‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡•ç‡§ü‡•ç‡§∞‡•â‡§®‡•ç‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à (8+, ‡§®‡§Ç‡§¨‡§∞, ‡§∏‡•ç‡§™‡•á‡§∂‡§≤).", "warn");
        return;
      }
      if (!note) {
        setStatus("‡§ï‡•É‡§™‡§Ø‡§æ ‡§®‡•ã‡§ü ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç‡•§", "warn");
        return;
      }

      const cipher = encryptNote(note, password);
      const meta = {
        emailHash: sha256Hex(email),
        fp: FP_VISITOR_ID || "(unavailable)",
        ts: new Date().toISOString(),
      };
      persist(cipher, meta);

      $("out").textContent = "Encrypted & saved! (Decrypt ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§æ‡§≤‡•á‡§Ç)";
      setStatus("‡§®‡•ã‡§ü ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§π‡•ã‡§ï‡§∞ ‡§≤‡•ã‡§ï‡§≤‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§Ø‡§æ‡•§", "ok");
    }

    async function handleDecrypt() {
      const password = $("password").value;
      const { cipher } = loadPersisted();

      if (!cipher) {
        setStatus("‡§ï‡•ã‡§à ‡§∏‡•á‡§µ‡•ç‡§° ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§®‡•ã‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§", "warn");
        $("out").textContent = "‚Äî";
        return;
      }
      if (!password) {
        setStatus("‡§™‡§π‡§≤‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§", "warn");
        return;
      }

      const text = decryptNote(cipher, password);
      if (text === null) {
        setStatus("‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§Ö‡§∏‡§´‡§≤ ‚Äî ‡§∂‡§æ‡§Ø‡§¶ ‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°‡•§", "err");
        $("out").textContent = "‚Äî";
        return;
      }

      $("out").textContent = text;
      setStatus("‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§∏‡§´‡§≤!", "ok");
    }

    async function handleCopy() {
      const text = $("out").textContent;
      if (text && text !== "‚Äî") {
        await navigator.clipboard.writeText(text);
        setStatus("‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§®‡•ã‡§ü ‡§ï‡•ç‡§≤‡§ø‡§™‡§¨‡•ã‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ‡•§", "ok");
      } else {
        setStatus("‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§π‡§≤‡•á ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§", "warn");
      }
    }

    function handleClear() {
      clearPersisted();
      $("out").textContent = "‚Äî";
      setStatus("‡§≤‡•ã‡§ï‡§≤‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§ï‡•ç‡§≤‡§ø‡§Ø‡§∞ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§", "ok");
    }

    async function handleSync() {
      const { cipher, meta } = loadPersisted();
      if (!cipher) {
        setStatus("‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§π‡§≤‡•á Encrypt & Save ‡§ï‡§∞‡•á‡§Ç‡•§", "warn");
        return;
      }
      setStatus("AJAX Sync ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à‚Ä¶", "info");

      const payload = {
        encrypted: cipher,
        meta: {
          ...meta,
          fpLive: FP_VISITOR_ID || "(unavailable)",
        },
        // ‡§°‡•á‡§Æ‡•ã ‡§ï‡•á ‡§≤‡§ø‡§è: ‡§π‡•à‡§∂‡•ç‡§° ‡§à‡§Æ‡•á‡§≤ ‡§î‡§∞ ‡§´‡§ø‡§Ç‡§ó‡§∞‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§π‡•Ä ‡§≠‡•á‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
      };

      try {
        // Demo endpoint: httpbin echoes back your POST
        const res = await fetch("https://httpbin.org/post", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
        });

        const data = await res.json();
        $("ajaxOut").textContent = JSON.stringify({
          status: res.status,
          json: data.json,
          headers: data.headers,
          origin: data.origin
        }, null, 2);

        setStatus("AJAX Sync ‡§∏‡§´‡§≤! (‡§°‡•á‡§Æ‡•ã ‡§∞‡§ø‡§∏‡•ç‡§™‡•â‡§®‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç)", "ok");
      } catch (err) {
        $("ajaxOut").textContent = "AJAX Error: " + (err?.message || String(err));
        setStatus("AJAX ‡§µ‡§ø‡§´‡§≤ ‚Äî ‡§∂‡§æ‡§Ø‡§¶ ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü/‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡•§", "err");
      }
    }

    // -------------------------------
    // Events
    // -------------------------------
    $("btnEncrypt").addEventListener("click", handleEncrypt);
    $("btnDecrypt").addEventListener("click", handleDecrypt);
    $("btnCopy").addEventListener("click", handleCopy);
    $("btnClear").addEventListener("click", handleClear);
    $("btnSync").addEventListener("click", handleSync);

    // ‡§ï‡•Å‡§õ UX ‡§π‡§ø‡§®‡•ç‡§ü‡•ç‡§∏ ‡§≤‡§æ‡§á‡§µ:
    $("email").addEventListener("input", (e) => {
      $("emailHelp").textContent = validateEmail(e.target.value) ? "‡§à‡§Æ‡•á‡§≤ ‡§Æ‡§æ‡§®‡•ç‡§Ø ‚úÖ" : "‡§à‡§Æ‡•á‡§≤ ‡§∏‡§π‡•Ä ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è";
    });

    $("password").addEventListener("input", (e) => {
      $("pwdHelp").textContent = validatePassword(e.target.value) ? "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡•ç‡§ü‡•ç‡§∞‡•â‡§®‡•ç‡§ó ‚úÖ" : "‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 8 ‡§Ö‡§ï‡•ç‡§∑‡§∞ + 1 ‡§®‡§Ç‡§¨‡§∞ + 1 ‡§∏‡•ç‡§™‡•á‡§∂‡§≤";
    });

    // Init on load
    window.addEventListener("load", () => {
      initFingerprint();
      // ‡§Ö‡§ó‡§∞ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§π‡•à ‡§§‡•ã ‡§¨‡§§‡§æ‡§è‡§Ç
      const { cipher } = loadPersisted();
      if (cipher) {
        setStatus("‡§è‡§ï ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§®‡•ã‡§ü ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§∏‡•á‡§µ‡•ç‡§° ‡§π‡•à‡•§ ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§æ‡§≤‡•á‡§Ç‡•§", "info");
      } else {
        setStatus("‡§®‡§Ø‡§æ ‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç, Encrypt & Save ‡§¶‡§¨‡§æ‡§è‡§Å‡•§", "info");
      }
    });
  </script>
</body>
</html>
